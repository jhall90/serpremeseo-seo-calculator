/*! seo-calculator-web-component v1.0.0 | MIT License | 2025 */
class SeoCalculator extends HTMLElement{static get observedAttributes(){return["brand-top","brand-bottom","chart-onpage","chart-tech","chart-offpage","chart-reporting","font-family","bg-light","panel-light","text-light","bg-dark","panel-dark","text-dark","theme"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=this.template,this._chart=null,this._themeAttr=this.getAttribute("theme")||"system"}get template(){return`
<style>
:host {
    /* Default theme variables (can be overridden by client or attributes) */
    --brand-top: var(--brand-top, #0e2a59);
    --brand-bottom: var(--brand-bottom, #163a7b);

    --chart-onpage: var(--chart-onpage, #00cc66);
    --chart-tech: var(--chart-tech, #ff6a00);
    --chart-offpage: var(--chart-offpage, #ffcc00);
    --chart-reporting: var(--chart-reporting, #7dd3fc);


    --font-family: var(--font-family, system-ui, sans-serif);

    /* Light theme defaults */
    --bg-light: var(--bg-light, #ffffff);
    --panel-light: var(--panel-light, #f8fafc);
    --text-light: var(--text-light, #111111);

    /* Dark theme defaults */
    --bg-dark: var(--bg-dark, #0f172a);
    --panel-dark: var(--panel-dark, #1e293b);
    --text-dark: var(--text-dark, #f1f5f9);

    display: block;
    font-family: var(--font-family);
}

.calculator {
    display: flex;
    max-width: 1100px;
    margin: 0 auto;
    border-radius: 20px;
    overflow: hidden;
    background: var(--panel-light);
    color: var(--text-light);
    padding: 30px;
}

:host(.dark) .calculator {
    background: var(--panel-dark);
    color: var(--text-dark);
}

.left-panel {
    flex: 1;
    padding-right: 30px;
}

.right-panel {
    width: 360px;
    padding: 30px;
    background: linear-gradient(180deg, var(--brand-top), var(--brand-bottom));
    color: #fff;
    border-radius: 12px;
}

.theme-toggle {
    margin-bottom: 20px;
    padding: 8px 16px;
    border-radius: 6px;
    border: 1px solid rgba(0,0,0,0.2);
    background: var(--panel-light);
    cursor: pointer;
    transition: 0.2s ease-in-out;

    font-family: inherit;      
    font-size: 14px;           
    font-weight: 500;          
    color: inherit;      
}
:host(.dark) .theme-toggle {
    background: var(--panel-dark);
    border-color: rgba(255,255,255,0.3);
    color: inherit;
}

.theme-toggle:hover {
    opacity: 0.8;
}

.input-row {
    margin-bottom: 20px;
}

label {
    font-weight: 600;
    margin-bottom: 8px;
    display: block;
}

select,
input[type="number"],
input {
    height: 46px;
    padding: 10px 12px;
    line-height: 1.4;
    border-radius: 8px;
    width: 100%;
    box-sizing: border-box;
    border: 1px solid rgba(255,255,255,0.15);
    background: var(--panel-light);
    color: inherit;
}

:host(.dark) select,
:host(.dark) input[type="number"],
:host(.dark) input {
    background: var(--panel-dark);
    border: 1px solid rgba(255,255,255,0.2);
}

/* Remove number spinner (Chrome, Edge, Safari) */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Remove spinner (Firefox) */
input[type="number"] {
    -moz-appearance: textfield;
}

select, input[type="number"] {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid rgba(0,0,0,0.15);
    font-size: 14px;
    background: var(--panel-light);
    color: inherit;
}
:host(.dark) select,
:host(.dark) input[type="number"] {
    background: var(--panel-dark);
    border-color: rgba(255,255,255,0.15);
    color: var(--text-dark);
}

.left-panel h1 {
    text-align: center;
}

.summary h1 {
    font-size: 32px;
    margin: 10px 0;
    text-align: center;
}

.summary h2 {
    text-align: center;
}

.summary ul {
    list-style: none;
    padding: 0;
    margin-top: 20px;
}
.summary li {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
}

canvas {
    width: 240px;
    height: 240px;
    margin: 20px auto;
}

.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: inline-block;
}
.dot.onpage { background: var(--chart-onpage); }
.dot.tech { background: var(--chart-tech); }
.dot.offpage { background: var(--chart-offpage); }
.dot.reporting { background: var(--chart-reporting); }

.legend {
    display: flex;
    justify-content: space-around;
    margin-top: 10px;
}

.label-with-info {
    display: flex;
    align-items: center;
    gap: 6px;
}

.info-icon {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: rgba(255,255,255,0.18);
    cursor: pointer;
    flex-shrink: 0;
}

.info-i {
    font-size: 11px;
    font-weight: 700;
    line-height: 1;
    transform: translateY(-0.5px); /* optical centering */
}


.info-icon:focus {
    outline: 2px solid rgba(255,255,255,0.4);
}

.tooltip {
    position: absolute;
    bottom: 130%;
    left: 50%;
    transform: translateX(-50%);
    background: #0f172a;
    color: #fff;
    padding: 10px 12px;
    border-radius: 8px;
    font-size: 12px;
    line-height: 1.4;
    width: max-content;
    max-width: 220px;
    white-space: normal;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    z-index: 20;
}

.info-icon:hover .tooltip,
.info-icon:focus .tooltip {
    opacity: 1;
    pointer-events: auto;
}


///////////////////
//    TABLET
///////////////////
:host(.tablet) {
    font-size: 16px;
}

:host(.tablet) h1 {
    font-size: 22px;
    text-align: center;
}

:host(.tablet) label {
    font-size: 15px;
    font-weight: 600;
}

:host(.tablet) select,
:host(.tablet) input[type="number"] {
    font-size: 16px;
    padding: 12px;
}

:host(.tablet) .right-panel h1 {
    font-size: 28px;
    text-align: center;
}

:host(.tablet) .right-panel h2 {
    font-size: 20px;
    text-align: center;
}

:host(.tablet) .calculator {
    flex-direction: column;
    padding: 0px;
}

:host(.tablet) .right-panel,
:host(.tablet) .left-panel {
    display: flex;
    flex-direction: column;
    width: 90%;
    margin: 3vw auto;      
    padding: 1.25rem;    
}

:host(.tablet) .right-panel {
    max-width: calc(100vw - 12vw); 
}

:host(.tablet) .right-panel {
    margin-top: 0px;
}

:host(.tablet) .legend {
    font-size: small;
}

:host(.tablet) canvas {
    width: 60% !important;
    height: 60% !important;
}

///////////////////
//    MOBILE
///////////////////
:host(.mobile) {
    font-size: 16px;
}

:host(.mobile) h1 {
    font-size: 22px;
    text-align: center;
}

:host(.mobile) label {
    font-size: 15px;
    font-weight: 600;
}

:host(.mobile) select,
:host(.mobile) input[type="number"] {
    font-size: 16px;
    padding: 12px;
}

:host(.mobile) .right-panel h1 {
    font-size: 28px;
    text-align: center;
}

:host(.mobile) .right-panel h2 {
    font-size: 20px;
    text-align: center;
}

:host(.mobile) .calculator {
    flex-direction: column;
    padding: 0px;
}

:host(.mobile) .right-panel,:host(.mobile) .left-panel {
    display: flex;
    width: 90%;
    padding: 1rem;
    flex-direction: column;
}

:host(.mobile) .right-panel {
    margin-top: 20px;
}

:host(.mobile) .legend {
    font-size: small;
}

:host(.mobile) canvas {
    width: 60% !important;
    height: 60% !important;
}
</style>

<div class="calculator">
    <div class="left-panel">
        <button class="theme-toggle">Toggle Theme</button>
        <h1>SEO Pricing Calculator</h1>

        <div class="input-row">
            <label class="label-with-info">
                Page Updates ($425 / page)
                <span class="info-icon" tabindex="0">
                    <span class="info-i">i</span>
                    <span class="tooltip">
                        Bulk discounts apply automatically:<br><br>
                        \u2022 20\u201339 pages: 0% off<br>
                        \u2022 40\u201399 pages: 5% off<br>
                        \u2022 100+ pages: 10% off
                    </span>
                </span>
            </label>
            <input type="number" id="pageUpdates" min="0" value="0">
        </div>

        <div class="input-row">
            <label>Blogs ($375 each)</label>
            <select id="blogs">
                <option value="0">None</option>
                <option value="2">2</option>
                <option value="4">4</option>
                <option value="6">6</option>
            </select>
        </div>

        <div class="input-row">
            <label>Videos ($675 each)</label>
            <select id="videos">
                <option value="0">None</option>
                <option value="2">2</option>
                <option value="4">4</option>
                <option value="6">6</option>
            </select>
        </div>

        <div class="input-row">
            <label>Backlinks ($625 each for 60+ DA)</label>
            <select id="backlinks">
                <option value="0">None</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="4">4</option>
            </select>
        </div>

        <div class="input-row">
            <label>Technical SEO ($600 / month)</label>
            <select id="techSeo">
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </select>
        </div>

        <div class="input-row">
            <label>Reporting & Analytics</label>
            <select id="reporting">
                <option value="none">None</option>
                <option value="one">One-Time ($1,000)</option>
                <option value="monthly">Monthly ($600 / mo)</option>
                <option value="quarterly">Quarterly ($333 / mo)</option>
            </select>
        </div>

        <div class="input-row">
            <label>Contract Length</label>
            <select id="contractLength">
                <option value="1">One Month</option>
                <option value="3">3 Months (5% Off)</option>
                <option value="6" selected>6 Months (10% Off)</option>
                <option value="12">12 Months (15% Off)</option>
            </select>
        </div>

    </div>

    <div class="right-panel">
        <div class="summary">
            <h2>Estimated Monthly Cost</h2>
            <h1 id="monthlyCost">$0</h1>
            <h2 class="one-time">One-Time Costs</h2>
            <h1 id="oneTimeCost">$0</h1>
            <ul>
                <li>Page Updates: <span id="pagesLabel"></span></li>
                <li>Blogs: <span id="blogsLabel"></span></li>
                <li>Videos: <span id="videosLabel"></span></li>
                <li>Backlinks: <span id="backlinksLabel"></span></li>
                <li>Technical SEO: <span id="techLabel"></span></li>
                <li>Reporting: <span id="reportingLabel"></span></li>
                <li>Contract: <span id="termLabel"></span></li>
            </ul>
        </div>

        <canvas id="paymentChart"></canvas>

        <div class="legend">
            <div><span class="dot onpage"></span> On-Page</div>
            <div><span class="dot tech"></span> Technical</div>
            <div><span class="dot offpage"></span> Off-Page</div>
            <div><span class="dot reporting"></span> Reporting</div>
        </div>
    </div>
</div>
        `}connectedCallback(){this._cacheDom(),this._readPageCssVars(),this._applyAttributeOverrides(),this._initThemeListener(),this._updateThemeClass(),this._updateResponsiveClasses(),window.addEventListener("resize",()=>this._updateResponsiveClasses()),this._loadChartJs().then(()=>{this._initChart(),this._attachEvents(),this._updateCalculator()})}_cacheDom(){const t=this.shadowRoot;this.$pageUpdates=t.getElementById("pageUpdates"),this.$blogs=t.getElementById("blogs"),this.$videos=t.getElementById("videos"),this.$backlinks=t.getElementById("backlinks"),this.$techSeo=t.getElementById("techSeo"),this.$reporting=t.getElementById("reporting"),this.$contractLength=t.getElementById("contractLength"),this.$monthlyCost=t.getElementById("monthlyCost"),this.$oneTimeCost=t.getElementById("oneTimeCost"),this.$pagesLabel=t.getElementById("pagesLabel"),this.$blogsLabel=t.getElementById("blogsLabel"),this.$videosLabel=t.getElementById("videosLabel"),this.$backlinksLabel=t.getElementById("backlinksLabel"),this.$techLabel=t.getElementById("techLabel"),this.$reportingLabel=t.getElementById("reportingLabel"),this.$termLabel=t.getElementById("termLabel"),this.$chartCanvas=t.getElementById("paymentChart"),this.$themeToggle=t.querySelector(".theme-toggle")}_readPageCssVars(){const t=["--brand-top","--brand-bottom","--chart-onpage","--chart-tech","--chart-offpage","--chart-reporting","--font-family","--bg-light","--panel-light","--text-light","--bg-dark","--panel-dark","--text-dark"],e=getComputedStyle(document.documentElement);t.forEach(o=>{const a=e.getPropertyValue(o).trim();a&&this.style.setProperty(o,a)})}_applyAttributeOverrides(){[...this.attributes].forEach(t=>{const e="--"+t.name.replace(/-(.)/g,(o,a)=>a.toLowerCase());this.style.setProperty(e,t.value)})}attributeChangedCallback(){this._applyAttributeOverrides(),this._updateChartColors()}_initThemeListener(){this.$themeToggle.addEventListener("click",()=>{const t=this.getAttribute("theme")||"system",e=t==="light"?"dark":t==="dark"?"system":"light";this.setAttribute("theme",e),this._themeAttr=e,this._updateThemeClass()})}_updateThemeClass(){const t=this.getAttribute("theme")||"system",e=window.matchMedia("(prefers-color-scheme: dark)").matches,o=document.body.classList.contains("dark-mode");let a=!1;t==="dark"?a=!0:t==="light"?a=!1:a=o||e,a?this.classList.add("dark"):this.classList.remove("dark")}_loadChartJs(){return window.Chart?Promise.resolve():new Promise(t=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/chart.js",e.onload=t,document.head.appendChild(e)})}_centerTextPlugin={id:"centerText",afterDraw:t=>{const{ctx:e,chartArea:{width:o,height:a}}=t,i=t.$centerText;if(!i||i.length===0)return;e.save(),e.textAlign="center",e.textBaseline="middle";const r=o/2+t.chartArea.left,l=a/2+t.chartArea.top,n=22;i.forEach((s,h)=>{e.fillStyle=s.color||"#ffffff",e.font=s.font||"600 20px sans-serif";const p=(h-(i.length-1)/2)*n;e.fillText(s.text,r,l+p)}),e.restore()}};_initChart(){const t=this.$chartCanvas.getContext("2d");this._chart=new Chart(t,{type:"doughnut",plugins:[this._centerTextPlugin],data:{labels:["On-Page","Technical","Off-Page","Reporting"],datasets:[{data:[0,0,0],backgroundColor:[this._css("--chart-onpage"),this._css("--chart-tech"),this._css("--chart-offpage"),this._css("--chart-reporting")],borderWidth:0}]},options:{cutout:"70%",plugins:{legend:!1,tooltip:!1},onHover:(e,o)=>{if(o.length>0){const a=o[0].index;this._updateCenterForSlice(a)}else this._updateCenterDefault()}}}),this._updateCenterDefault()}_updateCenterDefault(){const t=this._currentTotal||0;this._chart.$centerText=[{text:`$${t.toLocaleString()}`,font:"700 26px sans-serif"},{text:"/mo",font:"500 16px sans-serif",color:"rgba(255,255,255,0.8)"}],this._chart.draw()}_updateCenterForSlice(t){const e=this._chart.data.datasets[0].data,o=e.reduce((l,n)=>l+n,0),a=e[t];if(o===0)return;const i=Math.round(a/o*100),r=this._chart.data.labels[t];this._chart.$centerText=[{text:`${i}%`,font:"700 26px sans-serif"},{text:r,font:"500 18px sans-serif",color:"rgba(255,255,255,0.8)"}],this._chart.draw()}_css(t){return getComputedStyle(this).getPropertyValue(t).trim()}_updateChartColors(){this._chart&&(this._chart.data.datasets[0].backgroundColor=[this._css("--chart-onpage"),this._css("--chart-tech"),this._css("--chart-offpage"),this._css("--chart-reporting")],this._chart.update())}_attachEvents(){[this.$pageUpdates,this.$blogs,this.$videos,this.$backlinks,this.$techSeo,this.$reporting,this.$contractLength].forEach(t=>t.addEventListener("input",()=>this._updateCalculator()))}_updateCalculator(){const r={1:0,3:.05,6:.1,12:.15},l=x=>x>=100?.1:x>=40?.05:0,n=Number(this.$pageUpdates.value)||0,s=Number(this.$blogs.value),h=Number(this.$videos.value),p=Number(this.$backlinks.value),g=Number(this.$contractLength.value);let u=n*425;u*=1-l(n);const y=this.$reporting.value==="one"?1e3:0,k=Math.round(u+y);this.$oneTimeCost.textContent=`$${k.toLocaleString()}`;const C=s*375,$=this.$techSeo.value==="yes"?600:0,_=h*675+p*625;let c=0;this.$reporting.value==="monthly"&&(c=600),this.$reporting.value==="quarterly"&&(c=333);const d=r[g]||0,b=Math.ceil(C*(1-d)),m=Math.ceil($*(1-d)),f=Math.ceil(_*(1-d)),v=c>0?Math.ceil(c*(1-d)):0,w=b+m+f+v;this.$monthlyCost.textContent=`$${w.toLocaleString()}`,this.$pagesLabel.textContent=n>0?`${n} pages`:"None",this.$blogsLabel.textContent=s>0?`${s} / month`:"None",this.$videosLabel.textContent=h>0?`${h} / month`:"None",this.$backlinksLabel.textContent=p>0?`${p} links`:"None",this.$techLabel.textContent=this.$techSeo.value==="yes"?"$600 / month":"None",this.$reportingLabel.textContent=this.$reporting.value==="one"?"One-Time":this.$reporting.value==="quarterly"?"Quarterly ($333 / mo)":this.$reporting.value==="monthly"?"Monthly ($600 / mo)":"None",this.$termLabel.textContent=g===1?"One Month":`${g} Months`,this._updateChartData(b,m,f,v)}_updateChartData(t,e,o,a){const i=[t,e,o,a];this._chart.data.datasets[0].data=i,this._currentTotal=t+e+o+a,this._chart.update(),this._updateCenterDefault()}_updateResponsiveClasses(){const t=window.innerWidth,o=window.innerHeight>t,a=t<=550,i=t>550&&t<=1024;if(this.classList.remove("mobile","tablet"),a){this.classList.add("mobile");return}if(i&&o){this.classList.add("tablet");return}}}customElements.define("seo-calculator",SeoCalculator);
