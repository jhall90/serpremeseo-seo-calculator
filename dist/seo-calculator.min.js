/*! seo-calculator-web-component v1.0.0 | MIT License | 2025 */
class SeoCalculator extends HTMLElement{static get observedAttributes(){return["brand-top","brand-bottom","chart-onpage","chart-tech","chart-offpage","chart-reporting","font-family","bg-light","panel-light","text-light","bg-dark","panel-dark","text-dark","theme"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=this.template,this._chart=null,this._themeAttr=this.getAttribute("theme")||"system"}get template(){return`
<style>
:host {
    /* Base font size */
    font-size: 16px;

    /* Locked typography scale */
    --font-xs: 0.75rem;
    --font-sm: 0.875rem;
    --font-md: 1rem;
    --font-lg: 1.25rem;
    --font-xl: 2rem;

    /* Native option font size */
    --ui-option-font-size: 0.875rem;

    /* Theme variables */
    --brand-top: var(--brand-top, #0e2a59);
    --brand-bottom: var(--brand-bottom, #163a7b);

    --chart-onpage: var(--chart-onpage, #00cc66);
    --chart-tech: var(--chart-tech, #ff6a00);
    --chart-offpage: var(--chart-offpage, #ffcc00);
    --chart-reporting: var(--chart-reporting, #7dd3fc);

    --font-family: var(--font-family, system-ui, sans-serif);

    --bg-light: var(--bg-light, #ffffff);
    --panel-light: var(--panel-light, #f8fafc);
    --text-light: var(--text-light, #111111);

    --bg-dark: var(--bg-dark, #0f172a);
    --panel-dark: var(--panel-dark, #1e293b);
    --text-dark: var(--text-dark, #f1f5f9);

    display: block;
    font-family: var(--font-family);
}

/* =====================
    LAYOUT
===================== */

.calculator {
    display: flex;
    max-width: 1100px;
    margin: 0 auto;
    padding: 1.875rem;
    border-radius: 1.25rem;
    overflow: visible;
    background: var(--panel-light);
    color: var(--text-light);

    :host(.dark) & {
        background: var(--panel-dark);
        color: var(--text-dark);
    }
}

.left-panel {
    flex: 1;
    padding-right: 1.875rem;

    h1 {
        text-align: center;
    }
}

.right-panel {
    display: flex;
    flex-direction: column;
    width: 22.5rem;
    padding: 1.875rem;
    background: linear-gradient(180deg, var(--brand-top), var(--brand-bottom));
    color: #ffffff;
    border-radius: 0.75rem;
}

/* =====================
    SUMMARY POSITIONING
===================== */

.summary {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;

    h2 {
        margin: 0.5rem 0 0.25rem;
        font-size: var(--font-lg);
        font-weight: 600;
        line-height: 1.4;
        text-align: center;

        &.one-time,
        + h1 {
            margin-top: 1.25rem;
        }
    }

    h1 {
        margin: 0 0 1rem;
        font-size: var(--font-xl);
        font-weight: 700;
        line-height: 1.2;
        text-align: center;
    }

    ul {
        list-style: none;
        margin-top: 0.75rem;
        padding-left: 1rem;

        li {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            font-size: var(--ui-option-font-size);
            line-height: 1.4;
        }
    }
}

/* =====================
    BUTTON
===================== */

.theme-toggle {
    margin-bottom: 1.25rem;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    border: 0.0625rem solid rgba(0,0,0,0.2);
    background: var(--panel-light);
    cursor: pointer;
    transition: 0.2s ease-in-out;
    font-size: var(--font-sm);
    font-weight: 500;
    color: inherit;

    :host(.dark) & {
        background-color: var(--panel-dark);
        color: var(--text-dark);
    }
}

/* =====================
    INPUTS & SELECTS
===================== */

.input-row {
    margin-bottom: 1.25rem;
    position: relative;
    z-index: 1;

    /* elevate row when tooltip is active */
    &:has(.info-icon:hover),
    &:has(.info-icon:focus-visible) {
        z-index: 10;
    }

    label {
        font-size: var(--ui-option-font-size);
        font-weight: 500;
        line-height: 1.6;
        padding: 0.25rem 0;
        opacity: 0.9;
    }

    select,
    input,
    input[type="number"] {
        height: 2.875rem;
        padding: 0.625rem 0.75rem;
        line-height: 1.4;
        border-radius: 0.5rem;
        width: 100%;
        box-sizing: border-box;
        border: 0.0625rem solid rgba(255,255,255,0.15);
        background: var(--panel-light);
        color: inherit;
        font-size: var(--ui-option-font-size);

        :host(.dark) & {
            background-color: var(--panel-dark);
            color: var(--text-dark);
        }
    }
}

/* Native select colors */
select {
    background-color: var(--panel-light);
    color: var(--text-light);

    option {
        background-color: var(--panel-light);
        color: var(--text-light);

        &:hover,
        &:checked {
            background-color: rgba(255, 255, 255, 0.15);
        }
    }

    :host(.dark) & {
        background-color: var(--panel-dark);
        color: var(--text-dark);

        option {
            background-color: var(--panel-dark);
            color: var(--text-dark);
        }
    }
}

/* =====================
    INFO TOOLTIP
===================== */

.label-with-info {
    display: flex;
    align-items: center;
    gap: 0.375rem;

    .info-icon {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 1rem;
        height: 1rem;
        border-radius: 50%;
        background: rgba(255,255,255,0.18);
        cursor: pointer;

        &:hover .tooltip,
        &:focus-visible .tooltip {
            opacity: 1;
        }
    }

    .info-i {
        font-size: 0.688rem;
        font-weight: 700;
    }

    .tooltip {
        position: absolute;
        top: calc(100% + 0.5rem);
        left: 50%;
        transform: translateX(-50%);
        background: #0f172a;
        color: #ffffff;
        padding: 0.625rem 0.75rem;
        border-radius: 0.5rem;
        font-size: 0.75rem;
        max-width: 13.75rem;
        line-height: 1.4;
        opacity: 0;
        transition: opacity 0.2s ease;
        z-index: 20;
        width: 13rem;

        /* polish */
        pointer-events: none;
    }
}

/* =====================
    CHART & LEGEND
===================== */

/* Chart wrapper controls sizing, not canvas */
.chart-wrap {
    width: 100%;
    max-width: 18rem;        /* desktop default */
    margin: 1.25rem auto 0;

    canvas {
        width: 100% !important;
        height: auto !important;
        aspect-ratio: 1 / 1;
        display: block;
    }

}

.legend {
    display: flex;
    justify-content: space-between;
    width: 100%;
    margin-top: 0.75rem;
    font-size: var(--font-sm);

    span {
        display: flex;
        align-items: center;
        gap: 0.375rem;
    }

    .dot {
        width: 0.625rem;
        height: 0.625rem;
        border-radius: 50%;
        display: inline-block;

        &.onpage { background: var(--chart-onpage); }
        &.tech { background: var(--chart-tech); }
        &.offpage { background: var(--chart-offpage); }
        &.reporting { background: var(--chart-reporting); }
    }
}

/* =====================
    RESPONSIVE
===================== */

/* Mobile */
@media (max-width: 599px) {
    :host {
        /* Scale typography up for small screens */
        --font-xs: 0.875rem;   /* was 0.75 */
        --font-sm: 1rem;       /* was 0.875 */
        --font-md: 1.125rem;   /* new readable base */
        --font-lg: 1.375rem;   /* headings */
        --font-xl: 2.25rem;    /* totals */
    }

    .calculator {
        flex-direction: column;
        padding: 0;
    }

    .left-panel,
    .right-panel {
        width: 90%;
        padding: 1rem;
        inline-size: auto;
    }

    .chart-wrap {
        max-width: 26rem;
    }
}

/* Tablet */
@media (min-width: 600px) and (max-width: 1024px) {
    :host {
        /* Slightly less aggressive than mobile */
        --font-xs: 0.8125rem;
        --font-sm: 0.9375rem;
        --font-md: 1.0625rem;
        --font-lg: 1.3125rem;
        --font-xl: 2.125rem;
    }

    .calculator {
        flex-direction: column;
    }

    .left-panel,
    .right-panel {
        width: 90%;
        padding: 1.25rem;
        inline-size: auto;
    }

    .chart-wrap {
        max-width: 26rem;
    }
}

</style>






<div class="calculator">
    <div class="left-panel">
        <button class="theme-toggle">Toggle Theme</button>
        <h1>SEO Pricing Calculator</h1>

        <div class="input-row">
            <label class="label-with-info">
                Page Updates ($425 / page)
                <span class="info-icon" tabindex="0">
                    <span class="info-i">i</span>
                    <span class="tooltip">
                        Bulk discounts apply automatically:<br><br>
                        \u2022 20\u201339 pages: 0% off<br>
                        \u2022 40\u201399 pages: 5% off<br>
                        \u2022 100+ pages: 10% off
                    </span>
                </span>
            </label>
            <input type="number" id="pageUpdates" min="0" value="0">
        </div>

        <div class="input-row">
            <label>Blogs ($375 each)</label>
            <select id="blogs">
                <option value="0">None</option>
                <option value="2">2</option>
                <option value="4">4</option>
                <option value="6">6</option>
            </select>
        </div>

        <div class="input-row">
            <label>Videos ($675 each)</label>
            <select id="videos">
                <option value="0">None</option>
                <option value="2">2</option>
                <option value="4">4</option>
                <option value="6">6</option>
            </select>
        </div>

        <div class="input-row">
            <label>Backlinks ($625 each for 60+ DA)</label>
            <select id="backlinks">
                <option value="0">None</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="4">4</option>
            </select>
        </div>

        <div class="input-row">
            <label>Technical SEO ($600 / month)</label>
            <select id="techSeo">
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </select>
        </div>

        <div class="input-row">
            <label>Reporting & Analytics</label>
            <select id="reporting">
                <option value="none">None</option>
                <option value="one">One-Time ($1,000)</option>
                <option value="monthly">Monthly ($600 / mo)</option>
                <option value="quarterly">Quarterly ($333 / mo)</option>
            </select>
        </div>

        <div class="input-row">
            <label>Contract Length</label>
            <select id="contractLength">
                <option value="1">One Month</option>
                <option value="3">3 Months (5% Off)</option>
                <option value="6" selected>6 Months (10% Off)</option>
                <option value="12">12 Months (15% Off)</option>
            </select>
        </div>
    </div>

    <div class="right-panel">
        <div class="summary">
            <h2>Estimated Monthly Cost</h2>
            <h1 id="monthlyCost">$0</h1>
            <h2>One-Time Costs</h2>
            <h1 id="oneTimeCost">$0</h1>
            <ul>
                <li>Page Updates: <span id="pagesLabel"></span></li>
                <li>Blogs: <span id="blogsLabel"></span></li>
                <li>Videos: <span id="videosLabel"></span></li>
                <li>Backlinks: <span id="backlinksLabel"></span></li>
                <li>Technical SEO: <span id="techLabel"></span></li>
                <li>Reporting: <span id="reportingLabel"></span></li>
                <li>Contract: <span id="termLabel"></span></li>
            </ul>
        </div>

        <div class="chart-wrap">
            <canvas id="paymentChart"></canvas>
        </div>

        <div class="legend">
            <span><i class="dot onpage"></i> On-Page</span>
            <span><i class="dot tech"></i> Technical</span>
            <span><i class="dot offpage"></i> Off-Page</span>
            <span><i class="dot reporting"></i> Reporting</span>
        </div>

    </div>
</div>
        `}connectedCallback(){this._cacheDom(),this._readPageCssVars(),this._applyAttributeOverrides(),this._syncNativeOptionFontSize(),this._initThemeListener(),this._updateThemeClass(),window.addEventListener("resize",()=>{this._syncNativeOptionFontSize()}),this._loadChartJs().then(()=>{this._initChart(),this._attachEvents(),this._updateCalculator()})}_syncNativeOptionFontSize(){const t=document.createElement("select");t.size=2,t.style.position="absolute",t.style.left="-9999px",t.style.visibility="hidden",t.style.fontFamily=this._css("--font-family")||"system-ui";const e=document.createElement("option");e.textContent="Monthly ($600 / mo)",t.appendChild(e),this.shadowRoot.appendChild(t);const a=getComputedStyle(e).fontSize;t.remove(),a&&this.style.setProperty("--ui-option-font-size",a)}_cacheDom(){const t=this.shadowRoot;this.$pageUpdates=t.getElementById("pageUpdates"),this.$blogs=t.getElementById("blogs"),this.$videos=t.getElementById("videos"),this.$backlinks=t.getElementById("backlinks"),this.$techSeo=t.getElementById("techSeo"),this.$reporting=t.getElementById("reporting"),this.$contractLength=t.getElementById("contractLength"),this.$monthlyCost=t.getElementById("monthlyCost"),this.$oneTimeCost=t.getElementById("oneTimeCost"),this.$pagesLabel=t.getElementById("pagesLabel"),this.$blogsLabel=t.getElementById("blogsLabel"),this.$videosLabel=t.getElementById("videosLabel"),this.$backlinksLabel=t.getElementById("backlinksLabel"),this.$techLabel=t.getElementById("techLabel"),this.$reportingLabel=t.getElementById("reportingLabel"),this.$termLabel=t.getElementById("termLabel"),this.$chartCanvas=t.getElementById("paymentChart"),this.$themeToggle=t.querySelector(".theme-toggle")}_readPageCssVars(){const t=["--brand-top","--brand-bottom","--chart-onpage","--chart-tech","--chart-offpage","--chart-reporting","--font-family","--bg-light","--panel-light","--text-light","--bg-dark","--panel-dark","--text-dark"],e=getComputedStyle(document.documentElement);t.forEach(a=>{const o=e.getPropertyValue(a).trim();o&&this.style.setProperty(a,o)})}_applyAttributeOverrides(){[...this.attributes].forEach(t=>{const e="--"+t.name.replace(/-(.)/g,(a,o)=>o.toLowerCase());this.style.setProperty(e,t.value)})}attributeChangedCallback(){this._applyAttributeOverrides(),this._updateChartColors()}_initThemeListener(){this.$themeToggle.addEventListener("click",()=>{const t=this.getAttribute("theme")||"system",e=t==="light"?"dark":t==="dark"?"system":"light";this.setAttribute("theme",e),this._themeAttr=e,this._updateThemeClass()})}_updateThemeClass(){const t=this.getAttribute("theme")||"system",e=window.matchMedia("(prefers-color-scheme: dark)").matches,a=document.body.classList.contains("dark-mode");let o=!1;t==="dark"?o=!0:t==="light"?o=!1:o=a||e,o?this.classList.add("dark"):this.classList.remove("dark")}_loadChartJs(){return window.Chart?Promise.resolve():new Promise(t=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/chart.js",e.onload=t,document.head.appendChild(e)})}_centerTextPlugin={id:"centerText",afterDraw:t=>{const{ctx:e,chartArea:{width:a,height:o}}=t,i=t.$centerText;if(!i||i.length===0)return;e.save(),e.textAlign="center",e.textBaseline="middle";const r=a/2+t.chartArea.left,l=o/2+t.chartArea.top,n=22;i.forEach((s,c)=>{e.fillStyle=s.color||"#ffffff",e.font=s.font||"600 20px sans-serif";const h=(c-(i.length-1)/2)*n;e.fillText(s.text,r,l+h)}),e.restore()}};_initChart(){const t=this.$chartCanvas.getContext("2d");this._chart=new Chart(t,{type:"doughnut",plugins:[this._centerTextPlugin],data:{labels:["On-Page","Technical","Off-Page","Reporting"],datasets:[{data:[0,0,0],backgroundColor:[this._css("--chart-onpage"),this._css("--chart-tech"),this._css("--chart-offpage"),this._css("--chart-reporting")],borderWidth:0}]},options:{cutout:"70%",plugins:{legend:!1,tooltip:!1},onHover:(e,a)=>{if(a.length>0){const o=a[0].index;this._updateCenterForSlice(o)}else this._updateCenterDefault()}}}),this._updateCenterDefault()}_updateCenterDefault(){const t=this._currentTotal||0;this._chart.$centerText=[{text:`$${t.toLocaleString()}`,font:"700 26px sans-serif"},{text:"/mo",font:"500 16px sans-serif",color:"rgba(255,255,255,0.8)"}],this._chart.draw()}_updateCenterForSlice(t){const e=this._chart.data.datasets[0].data,a=e.reduce((l,n)=>l+n,0),o=e[t];if(a===0)return;const i=Math.round(o/a*100),r=this._chart.data.labels[t];this._chart.$centerText=[{text:`${i}%`,font:"700 26px sans-serif"},{text:r,font:"500 18px sans-serif",color:"rgba(255,255,255,0.8)"}],this._chart.draw()}_css(t){return getComputedStyle(this).getPropertyValue(t).trim()}_updateChartColors(){this._chart&&(this._chart.data.datasets[0].backgroundColor=[this._css("--chart-onpage"),this._css("--chart-tech"),this._css("--chart-offpage"),this._css("--chart-reporting")],this._chart.update())}_attachEvents(){[this.$pageUpdates,this.$blogs,this.$videos,this.$backlinks,this.$techSeo,this.$reporting,this.$contractLength].forEach(t=>t.addEventListener("input",()=>this._updateCalculator()))}_updateCalculator(){const r={1:0,3:.05,6:.1,12:.15},l=y=>y>=100?.1:y>=40?.05:0,n=Number(this.$pageUpdates.value)||0,s=Number(this.$blogs.value),c=Number(this.$videos.value),h=Number(this.$backlinks.value),g=Number(this.$contractLength.value);let m=n*425;m*=1-l(n);const x=this.$reporting.value==="one"?1e3:0,k=Math.round(m+x);this.$oneTimeCost.textContent=`$${k.toLocaleString()}`;const C=s*375,$=this.$techSeo.value==="yes"?600:0,_=c*675+h*625;let d=0;this.$reporting.value==="monthly"&&(d=600),this.$reporting.value==="quarterly"&&(d=333);const p=r[g]||0,f=Math.ceil(C*(1-p)),u=Math.ceil($*(1-p)),b=Math.ceil(_*(1-p)),v=d>0?Math.ceil(d*(1-p)):0,w=f+u+b+v;this.$monthlyCost.textContent=`$${w.toLocaleString()}`,this.$pagesLabel.textContent=n>0?`${n} pages`:"None",this.$blogsLabel.textContent=s>0?`${s} / month`:"None",this.$videosLabel.textContent=c>0?`${c} / month`:"None",this.$backlinksLabel.textContent=h>0?`${h} links`:"None",this.$techLabel.textContent=this.$techSeo.value==="yes"?"$600 / month":"None",this.$reportingLabel.textContent=this.$reporting.value==="one"?"One-Time":this.$reporting.value==="quarterly"?"Quarterly ($333 / mo)":this.$reporting.value==="monthly"?"Monthly ($600 / mo)":"None",this.$termLabel.textContent=g===1?"One Month":`${g} Months`,this._updateChartData(f,u,b,v)}_updateChartData(t,e,a,o){const i=[t,e,a,o];this._chart.data.datasets[0].data=i,this._currentTotal=t+e+a+o,this._chart.update(),this._updateCenterDefault()}}customElements.define("seo-calculator",SeoCalculator);
